<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô - OTOP ‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏ô‡∏≤‡πÄ‡∏ß‡∏µ‡∏¢‡∏á</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/cart.css">
</head>
<body>
    <nav id="navbar">
        <div class="nav-container">
            <a href="/index.html" class="nav-logo-container animate-fadeIn"><img src="img/logo-main.png" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ OTOP" class="nav-logo"></a>
            <ul class="nav-links">
                <li><a href="home.html" class="nav-link">‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</a></li>
                <li><a href="products.html" class="nav-link">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</a></li>
                <li><a href="about.html" class="nav-link">‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏ä‡∏∏‡∏°‡∏ä‡∏ô</a></li>
                <li><a href="contact.html" class="nav-link">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</a></li>
                <li><a href="account.html" class="nav-link">‡∏ö‡∏±‡∏ç‡∏ä‡∏µ</a></li>
                <li><a href="cart.html" class="nav-link active"><i class="fas fa-shopping-cart"></i> ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</a></li>
            </ul>
        </div>
    </nav>

    <main>
        <div class="container">
            <div class="cart-checkout-wrapper animate-fadeInUp reveal">
                <div class="cart active" id="cart-section">
                    <h1>‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h1>
                    <div class="cart-items"></div>
                    <div class="cart-total">‡∏£‡∏ß‡∏°: 0 ‡∏ö‡∏≤‡∏ó</div>
                    <div class="cart-checkout">
                        <button onclick="showCheckout()"><i class="fas fa-money-check-alt"></i> ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</button>
                    </div>
                </div>
                <div class="checkout" id="checkout-section">
                    <h1>‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</h1>
                    <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á/‡∏£‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</p>
                    <form class="checkout-form" id="checkout-form">
                        <div class="form-group">
                            <label for="name">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
                            <input type="text" id="name" required placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
                        </div>
                        <div class="form-group">
                            <label for="phone">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
                            <input type="tel" id="phone" required placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå">
                        </div>
                        <div class="form-group">
                            <label>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà</label>
                            <div class="address-radio-group" id="address-radio-group"></div>
                        </div>
                        <div class="new-address" id="new-address" style="display: none;">
                            <div class="form-group">
                                <label for="new-street">‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà/‡∏´‡∏°‡∏π‡πà/‡∏ñ‡∏ô‡∏ô</label>
                                <input type="text" id="new-street" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà/‡∏´‡∏°‡∏π‡πà/‡∏ñ‡∏ô‡∏ô">
                            </div>
                            <div class="form-group">
                                <label for="new-province">‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</label>
                                <select id="new-province" onchange="populateNewDistricts(this.value)">
                                    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="new-district">‡∏≠‡∏≥‡πÄ‡∏†‡∏≠</label>
                                <select id="new-district" onchange="populateNewSubdistricts(document.getElementById('new-province').value, this.value)" disabled>
                                    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏≥‡πÄ‡∏†‡∏≠</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="new-subdistrict">‡∏ï‡∏≥‡∏ö‡∏•</label>
                                <select id="new-subdistrict" onchange="updateNewZipcode()" disabled>
                                    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≥‡∏ö‡∏•</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="new-zipcode">‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå</label>
                                <input type="text" id="new-zipcode" readonly>
                            </div>
                        </div>
                        <button type="button" class="new-address-btn" onclick="addNewAddress()">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏´‡∏°‡πà</button>
                        <div class="cart-summary">
                            <h3>‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</h3>
                            <div id="cart-summary-items"></div>
                            <div>‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á</div>
                            <div class="total">‡∏£‡∏ß‡∏°: 0 ‡∏ö‡∏≤‡∏ó</div>
                        </div>
                        <div class="checkout-buttons">
                            <button type="button" class="confirm-btn" onclick="confirmCheckout()">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</button>
                            <button type="button" class="cancel-btn" onclick="showCart()">‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </main>

    <div class="custom-alert-overlay" id="alert-overlay" onclick="closeCustomAlert()">
        <div class="custom-alert" onclick="event.stopPropagation()">
            <div class="alert-content">
                <i id="alert-icon" class="fas fa-check-circle"></i>
                <h4 id="alert-title">‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</h4>
                <p id="alert-message">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</p>
            </div>
            <button onclick="closeCustomAlert()">‡∏ï‡∏Å‡∏•‡∏á</button>
        </div>
    </div>

    <footer id="contact">
        <div class="footer-container">
            <div class="footer-section reveal">
                <h3>‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏£‡πâ‡∏≤‡∏ô OTOP ‡∏ä‡∏∏‡∏°‡∏ä‡∏ô</h3>
                <p>‡πÄ‡∏£‡∏≤‡∏Ñ‡∏∑‡∏≠‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå OTOP ‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏™‡∏π‡∏á‡∏à‡∏≤‡∏Å‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏ô‡∏≤‡πÄ‡∏ß‡∏µ‡∏¢‡∏á ‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏á‡∏≤‡∏ô‡∏ù‡∏µ‡∏°‡∏∑‡∏≠‡∏ó‡πâ‡∏≠‡∏á‡∏ñ‡∏¥‡πà‡∏ô‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏±‡πà‡∏á‡∏¢‡∏∑‡∏ô</p>
                <div class="social-icons">
                    <a href="https://www.facebook.com/frxme.kitisuk" class="social-icon"><i class="fab fa-facebook-f"></i></a>
                    <a href="https://line.me/ti/p/MLQ2KzX_hh" class="social-icon"><i class="fab fa-line"></i></a>
                    <a href="https://www.instagram.com/f4x_me/" class="social-icon"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
            <div class="footer-section reveal">
                <h3>‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏î‡πà‡∏ß‡∏ô</h3>
                <ul class="footer-links">
                    <li><a href="home.html" class="footer-link">‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</a></li>
                    <li><a href="products.html" class="footer-link">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</a></li>
                    <li><a href="about.html" class="footer-link">‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏ä‡∏∏‡∏°‡∏ä‡∏ô</a></li>
                    <li><a href="contact.html" class="footer-link">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</a></li>
                </ul>
            </div>
            <div class="footer-section reveal">
                <h3>‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤</h3>
                <p><i class="fas fa-envelope"></i> ‡∏≠‡∏µ‡πÄ‡∏°‡∏•: piyasanw@gmail.com</p>
                <p><i class="fas fa-phone-alt"></i> ‡πÇ‡∏ó‡∏£: 06-23892553</p>
                <p><i class="fas fa-map-marker-alt"></i> ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà: ‡∏´‡∏°‡∏π‡πà 1 ‡∏ï.‡∏ô‡∏≤‡πÄ‡∏ß‡∏µ‡∏¢‡∏á ‡∏≠.‡πÄ‡∏™‡∏ô‡∏≤‡∏á‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏° ‡∏à.‡∏≠‡∏≥‡∏ô‡∏≤‡∏à‡πÄ‡∏à‡∏£‡∏¥‡∏ç 37290</p>
            </div>
        </div>
        <div class="footer-credit reveal">
            <p>¬© 2025 ‡∏£‡πâ‡∏≤‡∏ô OTOP ‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏ô‡∏≤‡πÄ‡∏ß‡∏µ‡∏¢‡∏á. ‡∏™‡∏á‡∏ß‡∏ô‡∏•‡∏¥‡∏Ç‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå.</p>
        </div>
    </footer>


    <script>
        // Generate unique order ID
        function generateOrderId() {
            const timestamp = Date.now();
            const random = Math.floor(Math.random() * 10000).toString().padStart(4, '0');
            return `ORD${timestamp}${random}`;
        }

        // Cart Management
        let cart = JSON.parse(localStorage.getItem('cart')) || [];

        function saveCart() {
            localStorage.setItem('cart', JSON.stringify(cart));
        }

        function updateCart() {
            const cartItemsContainer = document.querySelector('.cart-items');
            const cartSummaryItems = document.getElementById('cart-summary-items');
            cartItemsContainer.innerHTML = '';
            cartSummaryItems.innerHTML = '';
            let total = 0;

            if (cart.length === 0) {
                cartItemsContainer.innerHTML = '<p style="text-align: center; color: #4b5563;">‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤</p>';
            }

            cart.forEach((item, index) => {
                total += item.price * item.quantity;
                const cartItem = document.createElement('div');
                cartItem.className = 'cart-item animate-fadeInUp reveal';
                cartItem.style.animationDelay = `${index * 0.1}s`;
                cartItem.innerHTML = `
                    <img src="${item.image}" alt="${item.name}">
                    <div class="cart-item-info">
                        <h4>${item.name}</h4>
                        <p>${item.price} ‡∏ö‡∏≤‡∏ó x ${item.quantity}</p>
                    </div>
                    <div class="cart-item-controls">
                        <button onclick="updateQuantity(${index}, -1)">-</button>
                        <span>${item.quantity}</span>
                        <button onclick="updateQuantity(${index}, 1)">+</button>
                        <button class="delete-btn" onclick="removeFromCart(${index})"><i class="fas fa-trash-alt"></i></button>
                    </div>
                `;
                cartItemsContainer.appendChild(cartItem);

                const summaryItem = document.createElement('div');
                summaryItem.className = 'cart-summary-item';
                summaryItem.innerHTML = `
                    <p>${item.name} x ${item.quantity}</p>
                    <p>${item.price * item.quantity} ‡∏ö‡∏≤‡∏ó</p>
                `;
                cartSummaryItems.appendChild(summaryItem);
            });
            document.querySelector('.cart-total').textContent = `‡∏£‡∏ß‡∏°: ${total} ‡∏ö‡∏≤‡∏ó`;
            document.querySelector('.cart-summary .total').textContent = `‡∏£‡∏ß‡∏°: ${total} ‡∏ö‡∏≤‡∏ó`;
        }

        function updateQuantity(index, change) {
            cart[index].quantity += change;
            if (cart[index].quantity <= 0) cart.splice(index, 1);
            saveCart();
            updateCart();
        }

        function removeFromCart(index) {
            cart.splice(index, 1);
            saveCart();
            updateCart();
            showCustomAlert('success', '‡∏•‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', '‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ñ‡∏π‡∏Å‡∏•‡∏ö‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏∞');
        }

        // Address Management
        async function loadAddresses() {
            const addressRadioGroup = document.getElementById('address-radio-group');
            addressRadioGroup.innerHTML = '';
            const users = JSON.parse(localStorage.getItem('users')) || [];
            const loggedInEmail = localStorage.getItem('loggedInEmail');
            const user = users.find(u => u.email === loggedInEmail);
            const addresses = user ? user.addresses || [] : [];

            // Fetch address data for dropdowns
            let addressData = { provinces: [] };
            try {
                const response = await fetch('https://raw.githubusercontent.com/thailand-geography-data/thailand-geography-json/main/src/geography.json');
                if (!response.ok) throw new Error('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÑ‡∏î‡πâ');
                const data = await response.json();
                const provinces = {};
                data.forEach(item => {
                    if (!provinces[item.provinceNameTh]) {
                        provinces[item.provinceNameTh] = { districts: {} };
                    }
                    if (!provinces[item.provinceNameTh].districts[item.districtNameTh]) {
                        provinces[item.provinceNameTh].districts[item.districtNameTh] = { subdistricts: [] };
                    }
                    provinces[item.provinceNameTh].districts[item.districtNameTh].subdistricts.push({
                        name: item.subdistrictNameTh,
                        zipcode: item.postalCode
                    });
                });
                addressData = {
                    provinces: Object.keys(provinces).map(name => ({
                        name,
                        districts: Object.keys(provinces[name].districts).map(districtName => ({
                            name: districtName,
                            subdistricts: provinces[name].districts[districtName].subdistricts
                        }))
                    }))
                };
            } catch (error) {
                console.error('Error fetching address data:', error);
            }

            // Add existing addresses
            addresses.forEach((addr, index) => {
                const radioCard = document.createElement('div');
                radioCard.className = 'address-radio-card';
                radioCard.innerHTML = `
                    <input type="radio" name="address" id="address-${index}" value="${index}" onchange="toggleNewAddress()">
                    <label for="address-${index}">${addr.street}, ‡∏ï.${addr.subdistrict}, ‡∏≠.${addr.district}, ‡∏à.${addr.province}, ${addr.zipcode}</label>
                    <div class="address-radio-content">
                        <p><strong>‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà/‡∏´‡∏°‡∏π‡πà/‡∏ñ‡∏ô‡∏ô:</strong> ${addr.street}</p>
                        <p><strong>‡∏ï‡∏≥‡∏ö‡∏•:</strong> ${addr.subdistrict}</p>
                        <p><strong>‡∏≠‡∏≥‡πÄ‡∏†‡∏≠:</strong> ${addr.district}</p>
                        <p><strong>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î:</strong> ${addr.province}</p>
                        <p><strong>‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå:</strong> ${addr.zipcode}</p>
                    </div>
                `;
                addressRadioGroup.appendChild(radioCard);
            });

            // Add "New Address" option
            const newAddressRadio = document.createElement('div');
            newAddressRadio.className = 'address-radio-card new-address-card';
            newAddressRadio.innerHTML = `
                <input type="radio" name="address" id="new-address-radio" value="new" onchange="toggleNewAddress()">
                <label for="new-address-radio">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏´‡∏°‡πà</label>
                <div class="address-radio-content">
                    <p>‡∏Å‡∏£‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á</p>
                </div>
            `;
            addressRadioGroup.appendChild(newAddressRadio);

            // Update new address form with dropdowns
            const newAddressSection = document.getElementById('new-address');
            newAddressSection.innerHTML = `
                <div class="form-group">
                    <label for="new-street">‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà/‡∏´‡∏°‡∏π‡πà/‡∏ñ‡∏ô‡∏ô</label>
                    <input type="text" id="new-street" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà/‡∏´‡∏°‡∏π‡πà/‡∏ñ‡∏ô‡∏ô">
                </div>
                <div class="form-group">
                    <label for="new-province">‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</label>
                    <select id="new-province" onchange="populateNewDistricts(this.value)">
                        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</option>
                        ${addressData.provinces.sort((a, b) => a.name.localeCompare(b.name, 'th')).map(province => `<option value="${province.name}">${province.name}</option>`).join('')}
                    </select>
                </div>
                <div class="form-group">
                    <label for="new-district">‡∏≠‡∏≥‡πÄ‡∏†‡∏≠</label>
                    <select id="new-district" onchange="populateNewSubdistricts(document.getElementById('new-province').value, this.value)" disabled>
                        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏≥‡πÄ‡∏†‡∏≠</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="new-subdistrict">‡∏ï‡∏≥‡∏ö‡∏•</label>
                    <select id="new-subdistrict" onchange="updateNewZipcode()" disabled>
                        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≥‡∏ö‡∏•</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="new-zipcode">‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå</label>
                    <input type="text" id="new-zipcode" readonly>
                </div>
            `;

            toggleNewAddress();
        }

        async function populateNewDistricts(province) {
            const districtSelect = document.getElementById('new-district');
            const subdistrictSelect = document.getElementById('new-subdistrict');
            const zipcodeInput = document.getElementById('new-zipcode');
            districtSelect.innerHTML = '<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏≥‡πÄ‡∏†‡∏≠</option>';
            subdistrictSelect.innerHTML = '<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≥‡∏ö‡∏•</option>';
            districtSelect.disabled = true;
            subdistrictSelect.disabled = true;
            zipcodeInput.value = '';

            if (province) {
                const response = await fetch('https://raw.githubusercontent.com/thailand-geography-data/thailand-geography-json/main/src/geography.json');
                if (!response.ok) throw new Error('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÑ‡∏î‡πâ');
                const data = await response.json();
                const provinces = {};
                data.forEach(item => {
                    if (!provinces[item.provinceNameTh]) {
                        provinces[item.provinceNameTh] = { districts: {} };
                    }
                    if (!provinces[item.provinceNameTh].districts[item.districtNameTh]) {
                        provinces[item.provinceNameTh].districts[item.districtNameTh] = { subdistricts: [] };
                    }
                    provinces[item.provinceNameTh].districts[item.districtNameTh].subdistricts.push({
                        name: item.subdistrictNameTh,
                        zipcode: item.postalCode
                    });
                });
                const selectedProvince = Object.keys(provinces).find(p => p === province);
                if (selectedProvince) {
                    districtSelect.disabled = false;
                    Object.keys(provinces[selectedProvince].districts).sort((a, b) => a.localeCompare(b, 'th')).forEach(district => {
                        const option = document.createElement('option');
                        option.value = district;
                        option.textContent = district;
                        districtSelect.appendChild(option);
                    });
                }
            }
        }

        async function populateNewSubdistricts(province, district) {
            const subdistrictSelect = document.getElementById('new-subdistrict');
            const zipcodeInput = document.getElementById('new-zipcode');
            subdistrictSelect.innerHTML = '<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≥‡∏ö‡∏•</option>';
            subdistrictSelect.disabled = true;
            zipcodeInput.value = '';

            if (province && district) {
                const response = await fetch('https://raw.githubusercontent.com/thailand-geography-data/thailand-geography-json/main/src/geography.json');
                if (!response.ok) throw new Error('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÑ‡∏î‡πâ');
                const data = await response.json();
                const provinces = {};
                data.forEach(item => {
                    if (!provinces[item.provinceNameTh]) {
                        provinces[item.provinceNameTh] = { districts: {} };
                    }
                    if (!provinces[item.provinceNameTh].districts[item.districtNameTh]) {
                        provinces[item.provinceNameTh].districts[item.districtNameTh] = { subdistricts: [] };
                    }
                    provinces[item.provinceNameTh].districts[item.districtNameTh].subdistricts.push({
                        name: item.subdistrictNameTh,
                        zipcode: item.postalCode
                    });
                });
                const selectedProvince = provinces[province];
                const selectedDistrict = selectedProvince?.districts[district];
                if (selectedDistrict) {
                    subdistrictSelect.disabled = false;
                    selectedDistrict.subdistricts.sort((a, b) => a.name.localeCompare(b.name, 'th')).forEach(subdistrict => {
                        const option = document.createElement('option');
                        option.value = subdistrict.name;
                        option.textContent = subdistrict.name;
                        option.dataset.zipcode = subdistrict.zipcode;
                        subdistrictSelect.appendChild(option);
                    });
                }
            }
        }

        function updateNewZipcode() {
            const subdistrictSelect = document.getElementById('new-subdistrict');
            const zipcodeInput = document.getElementById('new-zipcode');
            const selectedOption = subdistrictSelect.options[subdistrictSelect.selectedIndex];
            zipcodeInput.value = selectedOption?.dataset.zipcode || '';
        }

        function toggleNewAddress() {
            const newAddressSection = document.getElementById('new-address');
            const selectedRadio = document.querySelector('input[name="address"]:checked');
            newAddressSection.style.display = selectedRadio && selectedRadio.value === 'new' ? 'block' : 'none';
        }

        function addNewAddress() {
            const street = document.getElementById('new-street').value;
            const subdistrict = document.getElementById('new-subdistrict').value;
            const district = document.getElementById('new-district').value;
            const province = document.getElementById('new-province').value;
            const zipcode = document.getElementById('new-zipcode').value;
            if (street && subdistrict && district && province && zipcode) {
                const users = JSON.parse(localStorage.getItem('users')) || [];
                const loggedInEmail = localStorage.getItem('loggedInEmail');
                const userIndex = users.findIndex(u => u.email === loggedInEmail);
                if (userIndex !== -1) {
                    const addresses = users[userIndex].addresses || [];
                    addresses.push({ street, subdistrict, district, province, zipcode });
                    users[userIndex].addresses = addresses;
                    localStorage.setItem('users', JSON.stringify(users));
                    loadAddresses();
                    document.getElementById('new-street').value = '';
                    document.getElementById('new-subdistrict').value = '';
                    document.getElementById('new-district').value = '';
                    document.getElementById('new-province').value = '';
                    document.getElementById('new-zipcode').value = '';
                    document.getElementById('new-address').style.display = 'none';
                    showCustomAlert('success', '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', '‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏´‡∏°‡πà‡∏ñ‡∏π‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏∞');
                } else {
                    showCustomAlert('error', '‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà');
                }
            } else {
                showCustomAlert('error', '‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô');
            }
        }

        // Toggle Cart and Checkout
        function showCheckout() {
            if (cart.length === 0) {
                showCustomAlert('info', '‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏•‡∏á‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏Ñ‡πà‡∏∞');
                return;
            }
            const users = JSON.parse(localStorage.getItem('users')) || [];
            const loggedInEmail = localStorage.getItem('loggedInEmail');
            const user = users.find(u => u.email === loggedInEmail);
            if (!user) {
                showCustomAlert('error', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô', '‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô');
                setTimeout(() => window.location.href = 'login.html', 2000);
                return;
            }
            document.getElementById('cart-section').style.display = 'none';
            document.getElementById('checkout-section').style.display = 'block';
            document.getElementById('cart-section').classList.remove('active');
            document.getElementById('checkout-section').classList.add('active');
            updateCart();
            loadAddresses();
            document.getElementById('name').value = user ? `${user.name || ''} ${user.surname || ''}`.trim() : '';
            document.getElementById('phone').value = user && user.phones && user.phones.length > 0 ? user.phones[0] : '';
            window.scrollTo({ top: document.getElementById('checkout-section').offsetTop - 100, behavior: 'smooth' });
        }

        function showCart() {
            document.getElementById('cart-section').style.display = 'block';
            document.getElementById('checkout-section').style.display = 'none';
            document.getElementById('cart-section').classList.add('active');
            document.getElementById('checkout-section').classList.remove('active');
            window.scrollTo({ top: document.getElementById('cart-section').offsetTop - 100, behavior: 'smooth' });
        }

        // Custom Alert Functions
        function showCustomAlert(type, title, message) {
            const overlay = document.getElementById('alert-overlay');
            const alertBox = overlay.querySelector('.custom-alert');
            const icon = document.getElementById('alert-icon');
            const alertTitle = document.getElementById('alert-title');
            const alertMessage = document.getElementById('alert-message');
            const button = overlay.querySelector('button');

            alertBox.classList.remove('success', 'error', 'info');
            button.classList.remove('error', 'info');

            if (type === 'success') {
                alertBox.classList.add('success');
                icon.className = 'fas fa-check-circle';
            } else if (type === 'error') {
                alertBox.classList.add('error');
                icon.className = 'fas fa-exclamation-circle';
                button.classList.add('error');
            } else if (type === 'info') {
                alertBox.classList.add('info');
                icon.className = 'fas fa-info-circle';
                button.classList.add('info');
            }

            alertTitle.textContent = title;
            alertMessage.textContent = message;
            overlay.classList.add('active');
        }

        function closeCustomAlert() {
            document.getElementById('alert-overlay').classList.remove('active');
        }

        // Checkout Confirmation with Discord Webhook
        async function confirmCheckout() {
            const name = document.getElementById('name').value;
            const phone = document.getElementById('phone').value;
            const selectedRadio = document.querySelector('input[name="address"]:checked');
            let addressDetails;

            const users = JSON.parse(localStorage.getItem('users')) || [];
            const loggedInEmail = localStorage.getItem('loggedInEmail');
            const userIndex = users.findIndex(u => u.email === loggedInEmail);
            if (userIndex === -1) {
                showCustomAlert('error', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô', '‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô');
                setTimeout(() => window.location.href = 'login.html', 2000);
                return;
            }

            const addresses = users[userIndex].addresses || [];
            if (!selectedRadio) {
                showCustomAlert('error', '‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏´‡∏°‡πà');
                return;
            }

            let newAddress = null;
            if (selectedRadio.value === 'new') {
                const street = document.getElementById('new-street').value;
                const subdistrict = document.getElementById('new-subdistrict').value;
                const district = document.getElementById('new-district').value;
                const province = document.getElementById('new-province').value;
                const zipcode = document.getElementById('new-zipcode').value;
                if (!street || !subdistrict || !district || !province || !zipcode) {
                    showCustomAlert('error', '‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô');
                    return;
                }
                newAddress = { street, subdistrict, district, province, zipcode };
                addressDetails = `${street}, ‡∏ï.${subdistrict}, ‡∏≠.${district}, ‡∏à.${province}, ${zipcode}`;
                addresses.push(newAddress);
                users[userIndex].addresses = addresses;
            } else {
                const selectedAddress = addresses[parseInt(selectedRadio.value)];
                addressDetails = `${selectedAddress.street}, ‡∏ï.${selectedAddress.subdistrict}, ‡∏≠.${selectedAddress.district}, ‡∏à.${selectedAddress.province}, ${selectedAddress.zipcode}`;
            }

            if (!name || !phone) {
                showCustomAlert('error', '‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå');
                return;
            }

            // Update user name and phone
            const [firstName, ...lastName] = name.split(' ');
            users[userIndex].name = firstName;
            users[userIndex].surname = lastName.join(' ');
            if (!users[userIndex].phones) users[userIndex].phones = [];
            if (!users[userIndex].phones.includes(phone)) {
                users[userIndex].phones.push(phone);
            }

            // Generate order ID and save purchase
            const orderId = generateOrderId();
            const orderDetails = {
                id: orderId,
                date: new Date().toISOString().split('T')[0],
                items: cart.map(item => ({
                    product: item.name,
                    quantity: item.quantity,
                    total: item.price * item.quantity
                })),
                total: cart.reduce((sum, item) => sum + item.price * item.quantity, 0),
                address: addressDetails
            };

            // Save purchase to user's purchase history
            if (!users[userIndex].purchases) users[userIndex].purchases = [];
            users[userIndex].purchases.push({
                id: orderId,
                date: orderDetails.date,
                product: cart.map(item => item.name).join(', '),
                quantity: cart.reduce((sum, item) => sum + item.quantity, 0),
                total: orderDetails.total
            });
            localStorage.setItem('users', JSON.stringify(users));

            // Format message for Discord using Embed
            const itemsList = cart.map(item => `‚Ä¢ ${item.name} x${item.quantity} (${item.price * item.quantity} ‡∏ö‡∏≤‡∏ó)`).join('\n');
            const discordMessage = {
                embeds: [{
                    title: "üõí ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡πÉ‡∏´‡∏°‡πà - OTOP ‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏ô‡∏≤‡πÄ‡∏ß‡∏µ‡∏¢‡∏á",
                    description: `‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡πÉ‡∏´‡∏°‡πà‡∏à‡∏≤‡∏Å‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ (‡∏£‡∏´‡∏±‡∏™: ${orderId})`,
                    color: 0x22c55e, // ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß (#22c55e)
                    fields: [
                        {
                            name: "üìú ‡∏£‡∏´‡∏±‡∏™‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠",
                            value: orderId,
                            inline: true
                        },
                        {
                            name: "üë§ ‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤",
                            value: name,
                            inline: true
                        },
                        {
                            name: "üìû ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå",
                            value: phone,
                            inline: true
                        },
                        {
                            name: "üè† ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á",
                            value: addressDetails,
                            inline: false
                        },
                        {
                            name: "üõçÔ∏è ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤",
                            value: itemsList || "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤",
                            inline: false
                        },
                        {
                            name: "üì¶ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î",
                            value: `${cart.reduce((sum, item) => sum + item.quantity, 0)} ‡∏ä‡∏¥‡πâ‡∏ô`,
                            inline: true
                        },
                        {
                            name: "üíµ ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ß‡∏°",
                            value: `${orderDetails.total} ‡∏ö‡∏≤‡∏ó`,
                            inline: true
                        },
                        {
                            name: "üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠",
                            value: new Date().toLocaleString('th-TH'),
                            inline: false
                        }
                    ],
                    footer: {
                        text: "‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô OTOP ‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏ô‡∏≤‡πÄ‡∏ß‡∏µ‡∏¢‡∏á! | ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠: piyasanw@gmail.com",
                        icon_url: "https://i.imgur.com/your-logo.png" // ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏î‡πâ‡∏ß‡∏¢ URL ‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏à‡∏£‡∏¥‡∏á
                    },
                    timestamp: new Date().toISOString()
                }]
            };

            try {
                const response = await fetch('https://discord.com/api/webhooks/1406904084396638248/6XX-tHZpT-FDlHj_FzS4n5EgU6twgj0qtZdmqlJLPQVmMS7PmGpwFVZl2k3LODtV6OhY', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(discordMessage)
                });

                if (response.ok) {
                    cart = [];
                    saveCart();
                    updateCart();
                    showCustomAlert('success', '‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', `‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì (‡∏£‡∏´‡∏±‡∏™: ${orderId}) ‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß! ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô OTOP ‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏ô‡∏≤‡πÄ‡∏ß‡∏µ‡∏¢‡∏á`);
                    setTimeout(() => {
                        window.location.href = 'products.html';
                    }, 2000);
                } else {
                    showCustomAlert('error', '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà');
                }
            } catch (error) {
                showCustomAlert('error', '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', '‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà');
            }
        }

        // Initialize
        window.addEventListener('load', () => {
            updateCart();
            loadAddresses();
        });

        // Scroll Animation
        window.addEventListener('scroll', () => {
            const navbar = document.getElementById('navbar');
            if (window.scrollY > 50) {
                navbar.classList.add('scrolled');
            } else {
                navbar.classList.remove('scrolled');
            }
            
            const reveals = document.querySelectorAll('.reveal');
            for (let i = 0; i < reveals.length; i++) {
                let windowHeight = window.innerHeight;
                let elementTop = reveals[i].getBoundingClientRect().top;
                let elementVisible = 150;
                if (elementTop < windowHeight - elementVisible) {
                    reveals[i].classList.add('active');
                } else {
                    reveals[i].classList.remove('active');
                }
            }
        });
    </script>
</body>
</html>